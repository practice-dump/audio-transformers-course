# Charger et explorer un jeu de donn√©es audio

Dans ce cours, nous utiliserons la biblioth√®que ü§ó *Datasets* pour travailler avec des jeux de donn√©es audio. 
ü§ó *Datasets* est une biblioth√®que open-source permettant de t√©l√©charger et de pr√©parer des jeux de donn√©es √† partir de toutes les modalit√©s, y compris l'audio. 
La biblioth√®que offre un acc√®s facile √† une s√©lection in√©gal√©e de jeux de donn√©es d'apprentissage automatique accessibles sur Hugging Face Hub. 
De plus, ü§ó *Datasets* comprend de multiples fonctionnalit√©s adapt√©es aux jeux de donn√©es audio simplifiant le travail avec de tels jeux de donn√©es pour les chercheurs et les praticiens.
Pour commencer √† utiliser des jeux de donn√©es audio, assurez-vous que la ü§ó *Datasets* est install√©e :

```bash
pip install datasets[audio]
```

L'une des principales caract√©ristiques d√©terminantes de ü§ó *Datasets*  est la possibilit√© de t√©l√©charger et de pr√©parer un jeu de donn√©es en une seule ligne de code Python √† l'aide de la fonction `load_dataset()`.
Chargeons et explorons un jeu de donn√©es audio appel√© [MINDS-14](https://huggingface.co/datasets/PolyAI/minds14), qui contient des enregistrements de personnes posant des questions √† un syst√®me bancaire √©lectronique dans plusieurs langues et dialectes.
Pour charger le jeu de donn√©es MINDS-14, nous devons copier l'identifiant du jeu de donn√©es sur le Hub (`PolyAI/minds14`) et le transmettre √† la fonction `load_dataset`.
Nous pr√©ciserons √©galement que nous ne nous int√©ressons qu'au sous-ensemble australien ('en-AU') des donn√©es, et le limiterons √† la division de l'entra√Ænement :

```py
from datasets import load_dataset

minds = load_dataset("PolyAI/minds14", name="en-AU", split="train")
minds
```

**Sortie :**

```out
Dataset(
    {
        features: [
            "path",
            "audio",
            "transcription",
            "english_transcription",
            "intent_class",
            "lang_id",
        ],
        num_rows: 654,
    }
)
```

Le jeu de donn√©es contient 654 fichiers audio, chacun √©tant accompagn√© d'une transcription, d'une traduction en anglais et d'une √©tiquette indiquant l'intention derri√®re la requ√™te de la personne. 
La colonne audio contient les donn√©es audio brutes. Examinons de plus pr√®s l'un des exemples:

```py
example = minds[0]
example
```

**Sortie :**

```out
{
    "path": "/root/.cache/huggingface/datasets/downloads/extracted/f14948e0e84be638dd7943ac36518a4cf3324e8b7aa331c5ab11541518e9368c/en-AU~PAY_BILL/response_4.wav",
    "audio": {
        "path": "/root/.cache/huggingface/datasets/downloads/extracted/f14948e0e84be638dd7943ac36518a4cf3324e8b7aa331c5ab11541518e9368c/en-AU~PAY_BILL/response_4.wav",
        "array": array(
            [0.0, 0.00024414, -0.00024414, ..., -0.00024414, 0.00024414, 0.0012207],
            dtype=float32,
        ),
        "sampling_rate": 8000,
    },
    "transcription": "I would like to pay my electricity bill using my card can you please assist",
    "english_transcription": "I would like to pay my electricity bill using my card can you please assist",
    "intent_class": 13,
    "lang_id": 2,
}
```

Vous remarquerez peut-√™tre que la colonne audio contient plusieurs caract√©ristiques :
* `path` : le chemin d'acc√®s au fichier audio (`*.wav` dans ce cas).
*  `array`: les donn√©es audio d√©cod√©es, repr√©sent√©es sous la forme d'un tableau NumPy √† 1 dimension.
* `sampling_rate` : taux d'√©chantillonnage du fichier audio (8 000 Hz dans cet exemple).
Le `intent_class` est une cat√©gorie de classification de l'enregistrement audio. Pour convertir ce nombre en une cha√Æne significative, nous pouvons utiliser la m√©thode `int2str()`:

```py
id2label = minds.features["intent_class"].int2str
id2label(example["intent_class"])
```

**Sortie :**

```out
"pay_bill"
```

Si vous regardez la fonction de transcription, vous pouvez voir que le fichier audio a effectivement enregistr√© une personne posant une question sur le paiement d'une facture.
Si vous envisagez d'entra√Æner un classifieur audio sur ce sous-ensemble de donn√©es, vous n'aurez pas n√©cessairement besoin de toutes les caract√©ristiques. 
Par exemple, le `lang_id` aura la m√™me valeur pour tous les exemples et ne sera pas utile. 
Les `english_transcription` dupliqueront probablement la `transcription` de ce sous-ensemble, afin que nous puissions les supprimer en toute s√©curit√©.

Vous pouvez facilement supprimer les caract√©ristiques non pertinentes √† l'aide de la m√©thode `remove_columns` de ü§ó *Datasets* :

```py
columns_to_remove = ["lang_id", "english_transcription"]
minds = minds.remove_columns(columns_to_remove)
minds
```

**Sortie :**

```out
Dataset({features: ["path", "audio", "transcription", "intent_class"], num_rows: 654})
```

Maintenant que nous avons charg√© et inspect√© le contenu brut du jeu de donn√©es, √©coutons quelques exemples ! Nous utiliserons les fonctionnalit√©s `Blocs` et `Audio` de *Gradio* pour d√©coder quelques √©chantillons al√©atoires du jeu de donn√©es:

```py
import gradio as gr


def generate_audio():
    example = minds.shuffle()[0]
    audio = example["audio"]
    return (
        audio["sampling_rate"],
        audio["array"],
    ), id2label(example["intent_class"])


with gr.Blocks() as demo:
    with gr.Column():
        for _ in range(4):
            audio, label = generate_audio()
            output = gr.Audio(audio, label=label)

demo.launch(debug=True)
```

Si vous le souhaitez, vous pouvez √©galement visualiser certains des exemples. Tra√ßons la forme d'onde pour le premier exemple.

```py
import librosa
import matplotlib.pyplot as plt
import librosa.display

array = example["audio"]["array"]
sampling_rate = example["audio"]["sampling_rate"]

plt.figure().set_figwidth(12)
librosa.display.waveshow(array, sr=sampling_rate)
```

<div class="flex justify-center">
    <img src="https://huggingface.co/datasets/huggingface-course/audio-course-images/resolve/main/waveform_unit1.png" alt="Waveform plot">
</div>

Essayez ! T√©l√©chargez un autre dialecte ou une autre langue du jeu de donn√©es MINDS-14, √©coutez et visualisez quelques exemples pour avoir une id√©e des variations du jeu de donn√©es. 
Vous pouvez trouver la liste compl√®te des langues disponibles [ici](https://huggingface.co/datasets/PolyAI/minds14).
