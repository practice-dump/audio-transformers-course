# –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ ASR

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–æ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ Whisper –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –Ω–∞ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö Common
Voice 13. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏—é –º–æ–¥–µ–ª–∏ 'small' –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –ø—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É
–¥–æ–≤–æ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ –Ω–∞ –ª—é–±–æ–º GPU –æ–±—ä–µ–º–æ–º –ø–∞–º—è—Ç–∏ 16 –ì–ë –∏ –±–æ–ª–µ–µ —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∫ –¥–∏—Å–∫–æ–≤–æ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É, –Ω–∞ —Ç–∞–∫–æ–º GPU –∫–∞–∫ T4
–æ–±—ä–µ–º–æ–º 16 –ì–ë, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–π –≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ Google Colab.

–ï—Å–ª–∏ —É –≤–∞—Å GPU —Å –º–µ–Ω—å—à–∏–º –æ–±—ä–µ–º–æ–º –ø–∞–º—è—Ç–∏ –∏–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è, –≤—ã –º–æ–∂–µ—Ç–µ —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–º —Å–æ–≤–µ—Ç–∞–º
–ø–æ —Å–Ω–∏–∂–µ–Ω–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ GPU —Å –±–û–ª—å—à–∏–º –æ–±—ä–µ–º–æ–º –ø–∞–º—è—Ç–∏, –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –æ–±—É—á–µ–Ω–∏—è –¥–ª—è
–º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —ç—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π –≤–∞—à–µ–≥–æ GPU!

–¢–∞–∫ –∂–µ —ç—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –¥–æ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å Whisper –¥–ª—è —è–∑—ã–∫–∞ –î–∏–≤–µ—Ö–∏. –û–¥–Ω–∞–∫–æ —à–∞–≥–∏, –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –∑–¥–µ—Å—å, –æ–±–æ–±—â–∞—é—Ç—Å—è –Ω–∞ –ª—é–±–æ–π
—è–∑—ã–∫ –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö Common Voice –∏ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –ª—é–±–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –Ω–∞ Hub Hugging Face. –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å
–∫–æ–¥, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –≤–∞–º —è–∑—ã–∫ –∏ –¥–æ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å Whisper –Ω–∞ –≤–∞—à–µ–º —Ä–æ–¥–Ω–æ–º —è–∑—ã–∫–µ üåç

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å —Å —ç—Ç–∏–º, –¥–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º –∏ –∑–∞–ø—É—Å—Ç–∏–º –Ω–∞—à—É –ø—Ä–æ—Ü–µ–¥—É—Ä—É –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏!

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ú—ã –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º –∑–∞–≥—Ä—É–∂–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –º–æ–¥–µ–ª–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∞ [Hugging Face Hub](https://huggingface.co/) –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è.
Hugging Face Hub –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π: –≤—ã –º–æ–∂–µ—Ç–µ –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –Ω–∏ –æ–¥–Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –º–æ–¥–µ–ª–∏ –Ω–µ –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è.
- –ñ—É—Ä–Ω–∞–ª—ã Tensorboard: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–∞–∂–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è.
- –ö–∞—Ä—Ç—ã –º–æ–¥–µ–ª–µ–π: –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å, –∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
- –°–æ–æ–±—â–µ—Å—Ç–≤–æ: –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –æ–±–º–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º! ü§ó

–°–≤—è–∑–∞—Ç—å –±–ª–æ–∫–Ω–æ—Ç —Å Hub Hugging Face –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ - –≤–∞–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ —Å–≤–æ–π —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Hugging Face Hub, –∫–æ–≥–¥–∞ –≤–∞—Å
–ø–æ–ø—Ä–æ—Å—è—Ç. –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Hugging Face Hub [–∑–¥–µ—Å—å](https://huggingface.co/settings/tokens) –∏ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ, –∫–æ–≥–¥–∞ –≤–∞—Å –ø–æ–ø—Ä–æ—Å—è—Ç:

```python
from huggingface_hub import notebook_login

notebook_login()
```

**Output:**
```bash
Login successful
Your token has been saved to /root/.huggingface/token
```

## –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

[Common Voice 13](https://huggingface.co/datasets/mozilla-foundation/common_voice_13_0) —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –¥–µ—Å—è—Ç—å —á–∞—Å–æ–≤
—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –î–∏–≤–µ—Ö–∏, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Ç—Ä–∏ —á–∞—Å–∞ —è–≤–ª—è—é—Ç—Å—è —Ç–µ—Å—Ç–æ–≤–æ–π —á–∞—Å—Ç—å—é –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∫—Ä–∞–π–Ω–µ –º–∞–ª–æ –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏,
–ø–æ—ç—Ç–æ–º—É –º—ã –±—É–¥–µ–º –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ –æ–±—à–∏—Ä–Ω—ã–µ –º–Ω–æ–≥–æ—è–∑—ã–∫–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è –≤ –æ–±–ª–∞—Å—Ç–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏, –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ Whisper –≤–æ –≤—Ä–µ–º—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ
–æ–±—É—á–µ–Ω–∏—è, –¥–ª—è –Ω–∏–∑–∫–æ—Ä–µ—Å—É—Ä—Å–Ω–æ–≥–æ —è–∑—ã–∫–∞ –î–∏–≤–µ—Ö–∏.

–ò—Å–ø–æ–ª—å–∑—É—è ü§ó Datasets, –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –ø—Ä–æ—Å—Ç—ã. –ú—ã –º–æ–∂–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Common
Voice 13 –≤—Å–µ–≥–æ –∑–∞ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –∫–æ–¥–∞. –¢–∞–∫ –∫–∞–∫ –î–∏–≤–µ—Ö–∏ –∏–º–µ–µ—Ç –æ—á–µ–Ω—å –Ω–µ–±–æ–ª—å—à–æ–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö, –º—ã –æ–±—ä–µ–¥–∏–Ω–∏–º –≤—ã–±–æ—Ä–∫–∏ `train` –∏ `validation`, —á—Ç–æ–±—ã
–ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Å–µ–º—å —á–∞—Å–æ–≤ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∏ —á–∞—Å–∞ –¥–∞–Ω–Ω—ã—Ö –≤—ã–±–æ—Ä–∫–∏ `test` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—à–µ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

```python
from datasets import load_dataset, DatasetDict

common_voice = DatasetDict()

common_voice["train"] = load_dataset(
    "mozilla-foundation/common_voice_13_0", "dv", split="train+validation"
)
common_voice["test"] = load_dataset(
    "mozilla-foundation/common_voice_13_0", "dv", split="test"
)

print(common_voice)
```

**Output:**
```
DatasetDict({
    train: Dataset({
        features: ['client_id', 'path', 'audio', 'sentence', 'up_votes', 'down_votes', 'age', 'gender', 'accent', 'locale', 'segment', 'variant'],
        num_rows: 4904
    })
    test: Dataset({
        features: ['client_id', 'path', 'audio', 'sentence', 'up_votes', 'down_votes', 'age', 'gender', 'accent', 'locale', 'segment', 'variant'],
        num_rows: 2212
    })
})
```

<Tip>
    –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —è–∑—ã–∫–∞ —Å `"dv"` –Ω–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —è–∑—ã–∫–∞ –ø–æ –≤–∞—à–µ–º—É –≤—ã–±–æ—Ä—É. –ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ
    —è–∑—ã–∫–∏ –≤ Common Voice 13, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –∫–∞—Ä—Ç–æ—á–∫–æ–π –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ Hub Hugging Face: https://huggingface.co/datasets/mozilla-foundation/common_voice_13_0
</Tip>

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Ç–æ–ª—å–∫–æ –∞—É–¥–∏–æ—Ñ–∞–π–ª—ã –¥–ª—è –≤–≤–æ–¥–∞ (`audio`) –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π
—Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (`sentence`). –í –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö Common Voice –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Ç–∞–∫–∞—è –∫–∞–∫ `accent`
–∏ `locale`, –∫–æ—Ç–æ—Ä—É—é –º—ã –º–æ–∂–µ–º –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å –¥–ª—è ASR. –°–æ—Ö—Ä–∞–Ω—è—è –±–ª–æ–∫–Ω–æ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –æ–±—â–∏–º, –º—ã –±—É–¥–µ–º —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ö–æ–¥–Ω–æ–µ
–∞—É–¥–∏–æ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, –æ—Ç–±—Ä–∞—Å—ã–≤–∞—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

```python
common_voice = common_voice.select_columns(["audio", "sentence"])
```

## –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫

–ö–æ–Ω–≤–µ–µ—Ä –¥–ª—è –∑–∞–¥–∞—á–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ —Ç—Ä–∏ —ç—Ç–∞–ø–∞:

1. –ò–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—ã—Ä–æ–π –∞—É–¥–∏–æ–≤–≤–æ–¥ –∏ —Å–æ–∑–¥–∞–µ—Ç –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∏–µ –º–µ–ª-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã
2. –ú–æ–¥–µ–ª—å, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. –¢–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ç–µ–∫—Å—Ç

–í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ ü§ó Transformers –¥–ª—è –º–æ–¥–µ–ª–∏ Whisper —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∏–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä, –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ
[WhisperFeatureExtractor](https://huggingface.co/docs/transformers/main/model_doc/whisper#transformers.WhisperFeatureExtractor)
–∏ [WhisperTokenizer](https://huggingface.co/docs/transformers/main/model_doc/whisper#transformers.WhisperTokenizer) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.
–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–º–∏, —ç—Ç–∏ –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Å–µ, –Ω–∞–∑–≤–∞–Ω–Ω–æ–º [WhisperProcessor](https://huggingface.co/docs/transformers/model_doc/whisper#transformers.WhisperProcessor).
–ú—ã –º–æ–∂–µ–º –≤—ã–∑–≤–∞—Ç—å WhisperProcessor –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–≤—É–∫–∞, —Ç–∞–∫ –∏ –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.
–ü—Ä–∏ —ç—Ç–æ–º –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –Ω–∞–º –Ω—É–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞: –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∏ –º–æ–¥–µ–ª—å.

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º–Ω–æ–≥–æ—è–∑—ã–∫–æ–≤–æ–≥–æ –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `"language"` –∏ `"task"` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.
–ü–∞—Ä–∞–º–µ—Ç—Ä `"language"` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —è–∑—ã–∫ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∞—É–¥–∏–æ, –∞ –ø–∞—Ä–∞–º–µ—Ç—Ä `"task"` –Ω–∞ `"transcribe"` –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –∏–ª–∏
–Ω–∞ `"translate"` –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ —Ä–µ—á–∏. –≠—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏–∑–º–µ–Ω—è—é—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ –∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å
–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –º–µ—Ç–æ–∫.

–ú—ã –º–æ–∂–µ–º —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏ –º–æ–¥–µ–ª—å—é Whisper, –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–≤ —Å–ø–∏—Å–æ–∫ —è–∑—ã–∫–æ–≤:

```python
from transformers.models.whisper.tokenization_whisper import TO_LANGUAGE_CODE

TO_LANGUAGE_CODE
```

–ï—Å–ª–∏ –≤—ã –ø—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫, –≤—ã –∑–∞–º–µ—Ç–∏—Ç–µ, —á—Ç–æ –º–Ω–æ–≥–∏–µ —è–∑—ã–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç, –Ω–æ –î–∏–≤–µ—Ö–∏ –≤ –Ω–µ–º –Ω–µ—Ç! –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å
Whisper –Ω–µ –±—ã–ª–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–∞ –Ω–∞ –î–∏–≤–µ—Ö–∏. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –Ω–µ –º–æ–∂–µ–º –¥–æ–æ–±—É—á–∏—Ç—å Whisper –Ω–∞ —ç—Ç–æ–º —è–∑—ã–∫–µ.
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –±—É–¥–µ–º –æ–±—É—á–∞—Ç—å Whisper –Ω–æ–≤–æ–º—É —è–∑—ã–∫—É, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–æ–π.
–≠—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –∫—Ä—É—Ç–æ, –Ω–µ —Ç–∞–∫ –ª–∏?

–ü—Ä–∏ –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã–π —è–∑—ã–∫ Whisper —Ö–æ—Ä–æ—à–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –æ –¥—Ä—É–≥–∏—Ö 96 —è–∑—ã–∫–∞—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —ç—Ç–∞ –º–æ–¥–µ–ª—å –±—ã–ª–∞
–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–∞. –í —Ü–µ–ª–æ–º, –≤—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —è–∑—ã–∫–∏ –±—É–¥—É—Ç –ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Ö–æ–∂–∏ —Ö–æ—Ç—è –±—ã –Ω–∞ –æ–¥–∏–Ω –∏–∑ 96 —è–∑—ã–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ Whisper
—É–∂–µ –∑–Ω–∞–µ—Ç, –∏ –º—ã –±—É–¥–µ–º –ø–æ–ø–∞–¥–∞—Ç—å –ø–æ–¥ —ç—Ç—É –ø–∞—Ä–∞–¥–∏–≥–º—É –∫—Ä–æ—Å—Å-—è–∑—ã–∫–æ–≤–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π.

–î–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ Whisper –Ω–∞ –Ω–æ–≤—ã–π —è–∑—ã–∫ –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ **—Å–∞–º—ã–π –ø–æ—Ö–æ–∂–∏–π** —è–∑—ã–∫, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º Whisper –±—ã–ª –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω.
–°—Ç–∞—Ç—å—è –≤ –í–∏–∫–∏–ø–µ–¥–∏–∏ –æ –î–∏–≤–µ—Ö–∏ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –î–∏–≤–µ—Ö–∏ —Ç–µ—Å–Ω–æ —Å–≤—è–∑–∞–Ω —Å –°–∏–Ω–≥–∞–ª—å—Å–∫–∏–º —è–∑—ã–∫–æ–º –®—Ä–∏-–õ–∞–Ω–∫–∏. –ï—Å–ª–∏ –º—ã —Å–Ω–æ–≤–∞ –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–¥—ã —è–∑—ã–∫–æ–≤,
–º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ –°–∏–Ω–≥–∞–ª—å—Å–∫–∏–π –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –Ω–∞–±–æ—Ä–µ —è–∑—ã–∫–æ–≤ Whisper, –ø–æ—ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç "language" –≤ –∑–Ω–∞—á–µ–Ω–∏–µ `"sinhalese"`.

–û—Ç–ª–∏—á–Ω–æ! –ú—ã –∑–∞–≥—Ä—É–∑–∏–º –Ω–∞—à –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∏–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ —è–∑—ã–∫ –Ω–∞ `"sinhalese"` –∏ –∑–∞–¥–∞—á—É –Ω–∞ `"transcribe"`,
–∫–∞–∫ –æ–±—ä—è—Å–Ω–µ–Ω–æ –≤—ã—à–µ:

```python
from transformers import WhisperProcessor

processor = WhisperProcessor.from_pretrained(
    "openai/whisper-small", language="sinhalese", task="transcribe"
)
```


–°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏—Ç–µ, —á—Ç–æ —è–∑—ã–∫, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å, –µ—Å—Ç—å –≤ –Ω–∞–±–æ—Ä–µ —è–∑—ã–∫–æ–≤
–ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —è–∑—ã–∫ –Ω–∞–ø—Ä—è–º—É—é –∫–∞–∫ —è–∑—ã–∫ –≤–∞—à–µ–≥–æ –∞—É–¥–∏–æ–≤–≤–æ–¥–∞! –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ,
—á—Ç–æ –æ–±–∞ —ç—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Å–ª–µ–¥—É–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç—å –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ, –∫–æ–≥–¥–∞ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —è–∑—ã–∫–∞ (`"English"`)
–∏ –∑–∞–¥–∞—á–∏ (`"transcribe"`).

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª—è–µ–º –∫–æ–ª–æ–Ω–∫–µ `"audio"` - —ç—Ç–æ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –æ —á–∞—Å—Ç–æ—Ç–µ
–¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –Ω–∞—à–∏—Ö –∞—É–¥–∏–æ–≤—Ö–æ–¥–æ–≤:

```python
common_voice["train"].features
```
**Output:**
```
{'audio': Audio(sampling_rate=48000, mono=True, decode=True, id=None),
 'sentence': Value(dtype='string', id=None)}
```

–ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—à–µ –≤—Ö–æ–¥–Ω–æ–π –∑–≤—É–∫ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–æ—Ç–µ 48 –∫–ì—Ü, –Ω–∞–º –Ω—É–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –¥–æ 16 –∫–ì—Ü
–ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –µ–≥–æ –≤ –∏–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ Whisper, —Ç–∞–∫ –∫–∞–∫ –º–æ–¥–µ–ª—å Whisper –æ–∂–∏–¥–∞–µ—Ç –∞—É–¥–∏–æ —Å —á–∞—Å—Ç–æ—Ç–æ–π –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ 16 –∫–ì—Ü.

–ú—ã —É—Å—Ç–∞–Ω–æ–≤–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é —á–∞—Å—Ç–æ—Ç—É –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –∞—É–¥–∏–æ–≤–≤–æ–¥–æ–≤ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ [`cast_column`](https://huggingface.co/docs/datasets/main/en/package_reference/main_classes#datasets.Dataset.cast_column).
–≠—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç –∑–≤—É–∫ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ, –∞ —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö –æ –ø–µ—Ä–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–∏ –∞—É–¥–∏–æ–æ–±—Ä–∞–∑—Ü–æ–≤ –ø—Ä–∏ –∏—Ö –∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞ –ª–µ—Ç—É:

```python
from datasets import Audio

sampling_rate = processor.feature_extractor.sampling_rate
common_voice = common_voice.cast_column("audio", Audio(sampling_rate=sampling_rate))
```

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–æ–¥–µ–ª—å—é:

1. –ú—ã –∑–∞–≥—Ä—É–∂–∞–µ–º –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—É–¥–∏–æ–¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—ã–±–æ—Ä–∫–∏, –≤—ã–∑—ã–≤–∞—è sample["audio"]. –ö–∞–∫ —É–∂–µ –±—ã–ª–æ –æ–±—ä—è—Å–Ω–µ–Ω–æ, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
ü§ó Datasets –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –ª–µ—Ç—É.
2. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –≤–∏–¥–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π –º–µ–ª-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑ –Ω–∞—à–µ–≥–æ –æ–¥–Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∞—É–¥–∏–æ-–º–∞—Å—Å–∏–≤–∞.
3. –ú—ã –∫–æ–¥–∏—Ä—É–µ–º —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –º–µ—Ç–æ–∫ —Å –ø–æ–º–æ—â—å—é —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞.

```python
def prepare_dataset(example):
    audio = example["audio"]

    example = processor(
        audio=audio["array"],
        sampling_rate=audio["sampling_rate"],
        text=example["sentence"],
    )

    # compute input length of audio sample in seconds
    example["input_length"] = len(audio["array"]) / audio["sampling_rate"]

    return example
```

–ú—ã –º–æ–∂–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–æ –≤—Å–µ–º –Ω–∞—à–∏–º –æ–±—É—á–∞—é—â–∏–º –ø—Ä–∏–º–µ—Ä–∞–º, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ `.map` –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ü§ó Datasets.
–ú—ã —É–¥–∞–ª–∏–º —Å—Ç–æ–ª–±—Ü—ã –∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ–±—É—á–µ–Ω–∏—è (–∞—É–¥–∏–æ –∏ —Ç–µ–∫—Å—Ç), –æ—Å—Ç–∞–≤–∏–≤ —Ç–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–µ–π `prepare_dataset`:

```python
common_voice = common_voice.map(
    prepare_dataset, remove_columns=common_voice.column_names["train"], num_proc=1
)
```

–ù–∞–∫–æ–Ω–µ—Ü, –º—ã —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ª—é–±—ã–µ –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Å –∞—É–¥–∏–æ–æ–±—Ä–∞–∑—Ü–∞–º–∏ –¥–ª–∏–Ω–Ω–µ–µ 30 —Å–µ–∫—É–Ω–¥. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–∏ –æ–±—Ä–∞–∑—Ü—ã –º–æ–≥–ª–∏ –±—ã –±—ã—Ç—å —É—Å–µ—á–µ–Ω—ã
–∏–∑–≤–ª–µ–∫–∞—Ç–µ–ª–µ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ Whisper, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è. –ú—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True` –¥–ª—è –æ–±—Ä–∞–∑—Ü–æ–≤,
–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Ä–æ—á–µ 30 —Å–µ–∫—É–Ω–¥, –∏ `False` –¥–ª—è —Ç–µ—Ö, —á—Ç–æ –¥–ª–∏–Ω–Ω–µ–µ:

```python
max_input_length = 30.0


def is_audio_in_length_range(length):
    return length < max_input_length
```

–ú—ã –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é —Ñ–∏–ª—å—Ç—Ä–∞ –∫ –≤—Å–µ–º –æ–±—Ä–∞–∑—Ü–∞–º –Ω–∞—à–µ–≥–æ –æ–±—É—á–∞—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `.filter` –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ü§ó Datasets:

```python
common_voice["train"] = common_voice["train"].filter(
    is_audio_in_length_range,
    input_columns=["input_length"],
)
```

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, —Å–∫–æ–ª—å–∫–æ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º—ã —É–¥–∞–ª–∏–ª–∏ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:

```python
common_voice["train"]
```
**Output**
```
Dataset({
    features: ['input_features', 'labels', 'input_length'],
    num_rows: 4904
})
```

–•–æ—Ä–æ—à–æ! –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —É –Ω–∞—Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–ª–æ—Å—å —Ç–∞–∫–æ–µ –∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–∑—Ü–æ–≤, —á—Ç–æ –∏ —Ä–∞–Ω—å—à–µ, —Ç–∞–∫ —á—Ç–æ –æ–±—Ä–∞–∑—Ü—ã –¥–ª–∏–Ω–Ω–µ–µ 30 —Å–µ–∫—É–Ω–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.
–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ —Ç–∞–∫, –µ—Å–ª–∏ –≤—ã –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç–µ —è–∑—ã–∫–∏, –ø–æ—ç—Ç–æ–º—É –ª—É—á—à–µ –æ—Å—Ç–∞–≤–∏—Ç—å —ç—Ç–æ—Ç —à–∞–≥ —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–∞ –º–µ—Å—Ç–µ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏. –¢–µ–ø–µ—Ä—å –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ
–ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è! –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏–º –∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ Whisper.

## –û–±—É—á–µ–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ, –º—ã –≥–æ—Ç–æ–≤—ã –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏. [ü§ó Trainer](https://huggingface.co/transformers/master/main_classes/trainer.html?highlight=trainer)
–≤—ã–ø–æ–ª–Ω–∏—Ç –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Ç—è–∂–µ–ª–æ–π —Ä–∞–±–æ—Ç—ã –∑–∞ –Ω–∞—Å. –í—Å–µ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–±–æ—Ä—â–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö: —Å–±–æ—Ä—â–∏–∫ –¥–∞–Ω–Ω—ã—Ö –±–µ—Ä–µ—Ç –Ω–∞—à–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –≥–æ—Ç–æ–≤–∏—Ç —Ç–µ–Ω–∑–æ—Ä—ã PyTorch, –≥–æ—Ç–æ–≤—ã–µ –¥–ª—è –º–æ–¥–µ–ª–∏.

- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç—Ä–∏–∫—É –æ—Ü–µ–Ω–∫–∏: –≤–æ –≤—Ä–µ–º—è –æ—Ü–µ–Ω–∫–∏ –º—ã —Ö–æ—Ç–∏–º –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –º–æ–¥–µ–ª—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç—Ä–∏–∫–∏ Word Error Rate (WER). –ù–∞–º –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `compute_metrics`, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç—Ç–æ—Ç —Ä–∞—Å—á–µ—Ç.

- –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Ç–æ—á–∫—É: –Ω–∞–º –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Ç–æ—á–∫—É –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –æ–±—É—á–µ–Ω–∏—è.

- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –æ–±—É—á–µ–Ω–∏—è: –æ–Ω–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è ü§ó Trainer –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è.

–ü–æ—Å–ª–µ –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –º—ã –±—É–¥–µ–º –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –µ–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—É—á–∏–ª–∏ –µ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —Ä–µ—á—å –Ω–∞ –î–∏–≤–µ—Ö–∏.

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–±–æ—Ä—â–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–°–±–æ—Ä—â–∏–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–æ–¥–µ–ª–∏ —Ä–µ—á–µ–≤–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏-–≤-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–Ω–∏–∫–∞–ª–µ–Ω –≤ —Ç–æ–º —Å–º—ã—Å–ª–µ, —á—Ç–æ –æ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `input_features` –∏
`labels` –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ: `input_features` –¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –∏–∑–≤–ª–µ–∫–∞—Ç–µ–ª–µ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∞ `labels` - —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º.

`input_features` —É–∂–µ –¥–æ–ø–æ–ª–Ω–µ–Ω—ã –ø–æ 30 —Å–µ–∫—É–Ω–¥ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫—É—é –º–µ–ª-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—É —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏, –ø–æ—ç—Ç–æ–º—É –≤—Å–µ,
—á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –ø–∞–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ–Ω–∑–æ—Ä—ã PyTorch. –ú—ã –¥–µ–ª–∞–µ–º —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `.pad` –∏–∑–≤–ª–µ–∫–∞—Ç–µ–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `return_tensors=pt`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ–Ω–∫–∞ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç
—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å, –∏ `input_features` –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ —Ç–µ–Ω–∑–æ—Ä—ã PyTorch.

–° –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, `labels` –Ω–µ –¥–æ–ø–æ–ª–Ω—è—é—Ç—Å—è. –°–Ω–∞—á–∞–ª–∞ –º—ã –¥–æ–ø–æ–ª–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã –≤ –ø–∞–∫–µ—Ç–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞
`.pad` —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞. –ó–∞—Ç–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ–º `-100`, —á—Ç–æ–±—ã —ç—Ç–∏ —Ç–æ–∫–µ–Ω—ã **–Ω–µ** —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –ø–æ—Ç–µ—Ä—å.
–ó–∞—Ç–µ–º –º—ã —É–¥–∞–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –∏–∑ –Ω–∞—á–∞–ª–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–µ—Ç–æ–∫, —Ç–∞–∫ –∫–∞–∫ –º—ã –¥–æ–±–∞–≤–∏–º –µ–≥–æ –ø–æ–∑–∂–µ –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è.

–ú—ã –º–æ–∂–µ–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º `WhisperProcessor`, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–∞–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–∑–≤–ª–µ–∫–∞—Ç–µ–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Ç–∞–∫ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞:

```python
import torch

from dataclasses import dataclass
from typing import Any, Dict, List, Union


@dataclass
class DataCollatorSpeechSeq2SeqWithPadding:
    processor: Any

    def __call__(
        self, features: List[Dict[str, Union[List[int], torch.Tensor]]]
    ) -> Dict[str, torch.Tensor]:
        # split inputs and labels since they have to be of different lengths and need different padding methods
        # first treat the audio inputs by simply returning torch tensors
        input_features = [
            {"input_features": feature["input_features"][0]} for feature in features
        ]
        batch = self.processor.feature_extractor.pad(input_features, return_tensors="pt")

        # get the tokenized label sequences
        label_features = [{"input_ids": feature["labels"]} for feature in features]
        # pad the labels to max length
        labels_batch = self.processor.tokenizer.pad(label_features, return_tensors="pt")

        # replace padding with -100 to ignore loss correctly
        labels = labels_batch["input_ids"].masked_fill(
            labels_batch.attention_mask.ne(1), -100
        )

        # if bos token is appended in previous tokenization step,
        # cut bos token here as it's append later anyways
        if (labels[:, 0] == self.processor.tokenizer.bos_token_id).all().cpu().item():
            labels = labels[:, 1:]

        batch["labels"] = labels

        return batch
```

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Å–±–æ—Ä—â–∏–∫ –¥–∞–Ω–Ω—ã—Ö:

```python
data_collator = DataCollatorSpeechSeq2SeqWithPadding(processor=processor)
```

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º!

### –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏

–î–∞–ª–µ–µ –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç—Ä–∏–∫—É –æ—Ü–µ–Ω–∫–∏, –∫–æ—Ç–æ—Ä—É—é –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –Ω–∞—à–µ–º –Ω–∞–±–æ—Ä–µ –¥–ª—è –æ—Ü–µ–Ω–∫–∏. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫—É
Word Error Rate (WER), –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –≤ —Ä–∞–∑–¥–µ–ª–µ [–û—Ü–µ–Ω–∫–∞](evaluation), —ç—Ç–æ "–¥–µ-—Ñ–∞–∫—Ç–æ" –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å–∏—Å—Ç–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏.

–î–∞–≤–∞–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏–º –º–µ—Ç—Ä–∏–∫—É WER –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ü§ó Evaluate:

```python
import evaluate

metric = evaluate.load("wer")
```

–ó–∞—Ç–µ–º –Ω–∞–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–µ—Ç—Ä–∏–∫—É WER. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è,
–Ω–∞–∑—ã–≤–∞–µ–º–∞—è `compute_metrics`, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–º–µ–Ω—è–µ—Ç `-100` –Ω–∞ `pad_token_id` –≤ `label_ids` (–æ—Ç–º–µ–Ω—è—è —à–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –≤
–∫–æ–ª–ª–µ–∫—Ç–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ –ø–æ—Ç–µ—Ä—å). –ó–∞—Ç–µ–º –æ–Ω –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ
–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –º–µ—Ç–æ–∫ –≤ —Å—Ç—Ä–æ–∫–∏. –ù–∞–∫–æ–Ω–µ—Ü, –æ–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç WER –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏ –∏ —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏.
–ó–¥–µ—Å—å —É –Ω–∞—Å –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∏—Ç—å "–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ" —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, —É –∫–æ—Ç–æ—Ä—ã—Ö —É–¥–∞–ª–µ–Ω—ã –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä.
–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ–º—É —Å–æ–≤–µ—Ç—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –æ—Ç —É–ª—É—á—à–µ–Ω–∏—è WER, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –ø—É—Ç–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π.

```python
from transformers.models.whisper.english_normalizer import BasicTextNormalizer

normalizer = BasicTextNormalizer()


def compute_metrics(pred):
    pred_ids = pred.predictions
    label_ids = pred.label_ids

    # replace -100 with the pad_token_id
    label_ids[label_ids == -100] = processor.tokenizer.pad_token_id

    # we do not want to group tokens when computing the metrics
    pred_str = processor.batch_decode(pred_ids, skip_special_tokens=True)
    label_str = processor.batch_decode(label_ids, skip_special_tokens=True)

    # compute orthographic wer
    wer_ortho = 100 * metric.compute(predictions=pred_str, references=label_str)

    # compute normalised WER
    pred_str_norm = [normalizer(pred) for pred in pred_str]
    label_str_norm = [normalizer(label) for label in label_str]
    # filtering step to only evaluate the samples that correspond to non-zero references:
    pred_str_norm = [
        pred_str_norm[i] for i in range(len(pred_str_norm)) if len(label_str_norm[i]) > 0
    ]
    label_str_norm = [
        label_str_norm[i]
        for i in range(len(label_str_norm))
        if len(label_str_norm[i]) > 0
    ]

    wer = 100 * metric.compute(predictions=pred_str_norm, references=label_str_norm)

    return {"wer_ortho": wer_ortho, "wer": wer}
```

### –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Ç–æ—á–∫—É

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏–º –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Ç–æ—á–∫—É Whisper small. –û–ø—è—Ç—å –∂–µ, —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é ü§ó Transformers –±–µ–∑ —Ç—Ä—É–¥–∞!

```python
from transformers import WhisperForConditionalGeneration

model = WhisperForConditionalGeneration.from_pretrained("openai/whisper-small")
```

–ú—ã —É—Å—Ç–∞–Ω–æ–≤–∏–º `use_cache` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ `False` –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º [–ø—Ä–æ–≤–µ—Ä–∫—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞](https://huggingface.co/docs/transformers/v4.18.0/en/performance#gradient-checkpointing),
–∏ —ç—Ç–∏ –¥–≤–µ –æ–ø—Ü–∏–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã. –ú—ã —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏–º –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —á—Ç–æ–±—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–≤–æ–¥–∞:
–º—ã –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–¥–∞–¥–∏–º —Ç–æ–∫–µ–Ω—ã —è–∑—ã–∫–∞ –∏ –∑–∞–¥–∞—á–∏ –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ã `language` –∏ `task`, –∏ —Ç–∞–∫–∂–µ —Å–Ω–æ–≤–∞ –≤–∫–ª—é—á–∏–º
–∫—ç—à –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —á—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–≤–æ–¥–∞:

```python
from functools import partial

# disable cache during training since it's incompatible with gradient checkpointing
model.config.use_cache = False

# set language and task for generation and re-enable cache
model.generate = partial(
    model.generate, language="sinhalese", task="transcribe", use_cache=True
)
```

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è

–ù–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —ç—Ç–∞–ø–µ –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ–±—É—á–µ–Ω–∏–µ–º. –ó–¥–µ—Å—å –º—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ 500.
–≠—Ç–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —à–∞–≥–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –±–æ–ª—å—à–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ WER –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é Whisper,
–ø—Ä–∏ —ç—Ç–æ–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–Ω–æ 45 –º–∏–Ω—É—Ç –≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ Google Colab.
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –æ–±—É—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ Seq2SeqTrainingArguments [–∑–¥–µ—Å—å](https://huggingface.co/docs/transformers/main_classes/trainer#transformers.Seq2SeqTrainingArguments).

```python
from transformers import Seq2SeqTrainingArguments

training_args = Seq2SeqTrainingArguments(
    output_dir="./whisper-small-dv",  # name on the HF Hub
    per_device_train_batch_size=16,
    gradient_accumulation_steps=1,  # increase by 2x for every 2x decrease in batch size
    learning_rate=1e-5,
    lr_scheduler_type="constant_with_warmup",
    warmup_steps=50,
    max_steps=500,  # increase to 4000 if you have your own GPU or a Colab paid plan
    gradient_checkpointing=True,
    fp16=True,
    fp16_full_eval=True,
    evaluation_strategy="steps",
    per_device_eval_batch_size=16,
    predict_with_generate=True,
    generation_max_length=225,
    save_steps=500,
    eval_steps=500,
    logging_steps=25,
    report_to=["tensorboard"],
    load_best_model_at_end=True,
    metric_for_best_model="wer",
    greater_is_better=False,
    push_to_hub=True,
)
```

<Tip>
    –ï—Å–ª–∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –º–æ–¥–µ–ª–∏ –Ω–∞ Hugging Face Hub, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `push_to_hub=False`.
</Tip>

–ú—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –æ–±—É—á–µ–Ω–∏—è –≤ ü§ó Trainer –≤–º–µ—Å—Ç–µ —Å –Ω–∞—à–µ–π –º–æ–¥–µ–ª—å—é, –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö, —Å–±–æ—Ä—â–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ—É–Ω–∫—Ü–∏–µ–π `compute_metrics`:

```python
from transformers import Seq2SeqTrainer

trainer = Seq2SeqTrainer(
    args=training_args,
    model=model,
    train_dataset=common_voice["train"],
    eval_dataset=common_voice["test"],
    data_collator=data_collator,
    compute_metrics=compute_metrics,
    tokenizer=processor,
)
```

–ò —Ç–µ–ø–µ—Ä—å –º—ã –≥–æ—Ç–æ–≤—ã –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –æ–±—É—á–µ–Ω–∏—é!

### –û–±—É—á–µ–Ω–∏–µ

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–±—É—á–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```python
trainer.train()
```

–û–±—É—á–µ–Ω–∏–µ –∑–∞–π–º–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 45 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–≥–æ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ —É—Å–∫–æ—Ä–∏—Ç–µ–ª—è –∏–ª–∏ —Ç–æ–≥–æ, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–µ–ª–µ–Ω –≤ Google Colab.
–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–≥–æ GPU –≤–æ–∑–º–æ–∂–Ω–æ, —á—Ç–æ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ–±—É—á–µ–Ω–∏—è –≤—ã —Å—Ç–æ–ª–∫–Ω–µ—Ç–µ—Å—å —Å –æ—à–∏–±–∫–æ–π CUDA "out-of-memory". –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ
–≤—ã –º–æ–∂–µ—Ç–µ —É–º–µ–Ω—å—à–∞—Ç—å `per_device_train_batch_size` –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–¥–≤–æ–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [`gradient_accumulation_steps`](https://huggingface.co/docs/transformers/main_classes/trainer#transformers.Seq2SeqTrainingArguments.gradient_accumulation_steps)
–¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏.

**Output:**

| Training Loss | Epoch | Step | Validation Loss | Wer Ortho | Wer     |
|:-------------:|:-----:|:----:|:---------------:|:---------:|:-------:|
| 0.136         | 1.63  | 500  | 0.1727          | 63.8972   | 14.0661 |

–ù–∞—à –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π WER —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 14,1% - –Ω–µ –ø–ª–æ—Ö–æ –¥–ª—è —Å–µ–º–∏ —á–∞—Å–æ–≤ –¥–∞–Ω–Ω—ã—Ö –æ–±—É—á–µ–Ω–∏—è –∏ –≤—Å–µ–≥–æ 500 —à–∞–≥–æ–≤ –æ–±—É—á–µ–Ω–∏—è! –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç
—É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 112% –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é! –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –≤–∑—è–ª–∏ –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–Ω–µ–µ –Ω–µ –∏–º–µ–ª–∞ –∑–Ω–∞–Ω–∏–π
–æ –î–∏–≤–µ—Ö–∏, –∏ —É—Å–ø–µ—à–Ω–æ –¥–æ–æ–±—É—á–∏–ª–∏ –µ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —Ä–µ—á—å –Ω–∞ –î–∏–≤–µ—Ö–∏ —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –º–µ–Ω–µ–µ —á–µ–º –∑–∞ –æ–¥–∏–Ω —á–∞—Å ü§Ø

–ë–æ–ª—å—à–æ–π –≤–æ–ø—Ä–æ—Å –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, –∫–∞–∫ —ç—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ [–¥–æ—Å–∫—É –ª–∏–¥–µ—Ä–æ–≤ autoevaluate](https://huggingface.co/spaces/autoevaluate/leaderboards?dataset=mozilla-foundation%2Fcommon_voice_13_0&only_verified=0&task=automatic-speech-recognition&config=dv&split=test&metric=wer),
–∫–æ—Ç–æ—Ä–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª–∏ –ø–æ —è–∑—ã–∫—É –∏ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö, –∞ –∑–∞—Ç–µ–º —Ä–∞–Ω–∂–∏—Ä—É–µ—Ç –∏—Ö –ø–æ –∏—Ö WER.

–ü–æ—Å–º–æ—Ç—Ä–µ–≤ –Ω–∞ –¥–æ—Å–∫—É –ª–∏–¥–µ—Ä–æ–≤, –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å, –æ–±—É—á–µ–Ω–Ω–∞—è –∑–∞ 500 —à–∞–≥–æ–≤, —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–≥–æ–Ω—è–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã–π [Whisper Small](https://huggingface.co/openai/whisper-small),
–∫–æ—Ç–æ—Ä—ã–π –º—ã –æ—Ü–µ–Ω–∏–≤–∞–ª–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ä–∞–∑–¥–µ–ª–µ. –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ üëè

–ú—ã –≤–∏–¥–∏–º, —á—Ç–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —á–µ–º —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã –æ–±—É—á–∏–ª–∏. –ü—Ä–µ–ª–µ—Å—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
Hugging Face Hub –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ *–∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è* –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ - –µ—Å–ª–∏ —É –Ω–∞—Å –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –±–æ–ª–µ–µ
–¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –º—ã –º–æ–∂–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Ç–æ—á–∫—É, –∫–æ—Ç–æ—Ä—É—é –∫—Ç–æ-—Ç–æ –∏–∑ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –æ–±—É—á–∏–ª –∏ –ª—é–±–µ–∑–Ω–æ –ø–æ–¥–µ–ª–∏–ª—Å—è –µ–π
(–Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å –µ–≥–æ –∑–∞ —ç—Ç–æ!). –í—ã —Å–º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —ç—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É—è
–∫–ª–∞—Å—Å `pipeline`, –∫–∞–∫ –º—ã –¥–µ–ª–∞–ª–∏ —Ä–∞–Ω–µ–µ! –¢–∞–∫ —á—Ç–æ –Ω–µ—Ç –Ω–∏—á–µ–≥–æ, —á—Ç–æ –±—ã –º–æ–≥–ª–æ –ø–æ–º–µ—à–∞—Ç—å –≤–∞–º –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –∏–∑ –¥–æ—Å–∫–∏ –ª–∏–¥–µ—Ä–æ–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –≤–∞—à–µ–π –∑–∞–¥–∞—á–µ!

–ú—ã –º–æ–∂–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—à—É –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Ç–æ—á–∫—É –Ω–∞ –¥–æ—Å–∫—É –ª–∏–¥–µ—Ä–æ–≤, –∫–æ–≥–¥–∞ –º—ã –ø—É–±–ª–∏–∫—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è –Ω–∞ Hugging Face Hub - –Ω–∞–º
–ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (kwargs). –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è, —á—Ç–æ–±—ã –æ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –≤–∞—à–µ–º—É –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö,
—è–∑—ã–∫—É –∏ –∏–º–µ–Ω–∏ –º–æ–¥–µ–ª–∏:

```python
kwargs = {
    "dataset_tags": "mozilla-foundation/common_voice_13_0",
    "dataset": "Common Voice 13",  # a 'pretty' name for the training dataset
    "language": "dv",
    "model_name": "Whisper Small Dv - Sanchit Gandhi",  # a 'pretty' name for your model
    "finetuned_from": "openai/whisper-small",
    "tasks": "automatic-speech-recognition",
}
```

–¢–µ–ø–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ Hugging Face Hub. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É push_to_hub:

```python
trainer.push_to_hub(**kwargs)
```

–≠—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –∂—É—Ä–Ω–∞–ª—ã –æ–±—É—á–µ–Ω–∏—è –∏ –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏ –≤ –ø–∞–ø–∫–µ `"–≤–∞—à–µ-–∏–º—è-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–∏–º—è-–∫–æ—Ç–æ—Ä–æ–µ-–≤—ã-–≤—ã–±—Ä–∞–ª–∏"`. –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ
–∑–∞–≥—Ä—É–∑–∫—É –ø–æ –∞–¥—Ä–µ—Å—É `sanchit-gandhi/whisper-small-dv`.

–•–æ—Ç—è –¥–æ–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–∞–µ—Ç —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö Common Voice 13 –Ω–∞ –î–∏–≤–µ—Ö–∏, —ç—Ç–æ –¥–∞–ª–µ–∫–æ –Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
–¶–µ–ª—å –¥–∞–Ω–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ - –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å ASR —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ü§ó Trainer –¥–ª—è –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏.

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º—É GPU –∏–ª–∏ –≤—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω Google Colab, –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–µ–ª–∏—á–∏—Ç—å max_steps –¥–æ 4000, —á—Ç–æ–±—ã
–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å WER, –æ–±—É—á–∞—è—Å—å –±–æ–ª—å—à–µ —à–∞–≥–æ–≤. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ 4000 —à–∞–≥–æ–≤ –∑–∞–π–º–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 3-5 —á–∞—Å–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–≥–æ GPU –∏ –ø—Ä–∏–≤–µ–¥–µ—Ç
–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º WER –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 3% –Ω–∏–∂–µ, —á–µ–º –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –Ω–∞ 500 —à–∞–≥–∞—Ö. –ï—Å–ª–∏ –≤—ã —Ä–µ—à–∏—Ç–µ –æ–±—É—á–∏—Ç—å –Ω–∞ 4000 —à–∞–≥–æ–≤, –º—ã —Ç–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏–∑–º–µ–Ω–∏—Ç—å
–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ *–ª–∏–Ω–µ–π–Ω—ã–π* (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `lr_scheduler_type="linear"`), —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —Ç–∞–∫–∂–µ –ø—Ä–∏–Ω–µ—Å–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—É—á–∞—é—â–∏—Ö—Å—è —Å–µ—Å—Å–∏—è—Ö.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –¥–∞–ª—å—à–µ —É–ª—É—á—à–µ–Ω—ã –ø—É—Ç–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—É—á–µ–Ω–∏—è, —Ç–∞–∫–∏—Ö –∫–∞–∫ _—Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è_ (_learning rate_) –∏ _dropout_,
–∞ —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω–æ–π –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ (`medium` –∏–ª–∏ `large`). –ú—ã –æ—Å—Ç–∞–≤–ª—è–µ–º —ç—Ç–æ –∫–∞–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è —á–∏—Ç–∞—Ç–µ–ª—è.

## –°–æ–≤–º–µ—Å—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥–µ–ª–∏

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —ç—Ç–æ–π –º–æ–¥–µ–ª—å—é —Å –ª—é–±—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Å—ã–ª–∫—É –Ω–∞ Hugging Face Hub. –û–Ω–∏ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –µ–µ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º
`"your-username/the-name-you-picked"` –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –æ–±—ä–µ–∫—Ç `pipeline()`. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π
—Ç–æ—á–∫–∏ ["sanchit-gandhi/whisper-small-dv"](https://huggingface.co/sanchit-gandhi/whisper-small-dv):

```python
from transformers import pipeline

pipe = pipeline("automatic-speech-recognition", model="sanchit-gandhi/whisper-small-dv")
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –ø–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–æ–æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ Whisper –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ü§ó Datasets,
Transformers –∏ Hugging Face Hub. –°–Ω–∞—á–∞–ª–∞ –º—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö Dhivehi –∏–∑ Common Voice 13 –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –µ–≥–æ, –≤—ã—á–∏—Å–ª–∏–≤ –ª–æ–≥-–º–µ–ª-—Å–ø–µ–∫—Ç—Ä–æ–≥—Ä–∞–º–º—ã
–∏ —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–≤ —Ç–µ–∫—Å—Ç. –ó–∞—Ç–µ–º –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —Å–ø–æ—Å–æ–± –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –º–µ—Ç—Ä–∏–∫—É –æ—Ü–µ–Ω–∫–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è, –ø—Ä–µ–∂–¥–µ —á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ü§ó Trainer
–¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –æ—Ü–µ–Ω–∫–∏ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏. –ú—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏, –∑–∞–≥—Ä—É–∑–∏–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –Ω–∞ Hugging Face Hub, –∏ –ø–æ–∫–∞–∑–∞–ª–∏, –∫–∞–∫ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–µ
—Å –ø–æ–º–æ—â—å—é –∫–ª–∞—Å—Å–∞ `pipeline()`.

–ï—Å–ª–∏ –≤—ã —Å–ª–µ–¥–æ–≤–∞–ª–∏ —ç—Ç–æ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É –¥–æ —ç—Ç–æ–π —Ç–æ—á–∫–∏, —É –≤–∞—Å —Ç–µ–ø–µ—Ä—å –µ—Å—Ç—å –¥–æ–æ–±—É—á–µ–Ω–Ω–∞—è –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏, –æ—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! ü•≥
–ï—â–µ –±–æ–ª–µ–µ –≤–∞–∂–Ω–æ —Ç–æ, —á—Ç–æ –≤—ã —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ Whisper –Ω–∞ –ª—é–±–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –≤ –ª—é–±–æ–π –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π
–æ–±–ª–∞—Å—Ç–∏. –¢–∞–∫ —á—Ç–æ —á–µ–≥–æ –≤—ã –∂–¥–µ—Ç–µ! –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –æ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–¥–µ–ª–µ [–í—ã–±–æ—Ä –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](choosing_dataset), –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π
—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, —Å–º–æ–∂–µ—Ç–µ –ª–∏ –≤—ã –¥–æ—Å—Ç–∏—á—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (state-of-the-art performance)! –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –∂–¥–µ—Ç –≤–∞—Å...