# Evaluation metrics for ASR

–ï—Å–ª–∏ –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å [—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞](https://en.wikipedia.org/wiki/Levenshtein_distance) –∏–∑ NLP —Ç–æ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏
—Å–∏—Å—Ç–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –±—É–¥—É—Ç –≤–∞–º –∑–Ω–∞–∫–æ–º—ã! –ù–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å, –µ—Å–ª–∏ –Ω–µ—Ç, –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞, —á—Ç–æ–±—ã
—É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—ã –∑–Ω–∞–µ—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –ø–æ–Ω–∏–º–∞–µ—Ç–µ, —á—Ç–æ –æ–Ω–∏ –æ–∑–Ω–∞—á–∞—é—Ç.

–ü—Ä–∏ –æ—Ü–µ–Ω–∫–µ —Å–∏—Å—Ç–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –º—ã —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–µ–π —Ü–µ–ª–µ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, –∞–Ω–Ω–æ—Ç–∏—Ä—É—è –≤—Å–µ –∏–º–µ—é—â–∏–µ—Å—è –æ—à–∏–±–∫–∏.
–ú—ã –æ—Ç–Ω–æ—Å–∏–º —ç—Ç–∏ –æ—à–∏–±–∫–∏ –∫ –æ–¥–Ω–æ–π –∏–∑ —Ç—Ä–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
1. –ó–∞–º–µ–Ω—ã (S - –æ—Ç –∞–Ω–≥–ª. "Substitutions"): –∫–æ–≥–¥–∞ –º—ã —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä—É–µ–º **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ** –≤ –Ω–∞—à–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏ ("sit" –≤–º–µ—Å—Ç–æ "sat")
2. –í—Å—Ç–∞–≤–∫–∏ (I - –æ—Ç –∞–Ω–≥–ª. "Insertions"): –∫–æ–≥–¥–∞ –º—ã –¥–æ–±–∞–≤–ª—è–µ–º **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ** –≤ –Ω–∞—à–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
3. –£–¥–∞–ª–µ–Ω–∏—è (D - –æ—Ç –∞–Ω–≥–ª. "Deletions"): –∫–æ–≥–¥–∞ –º—ã **—É–¥–∞–ª—è–µ–º —Å–ª–æ–≤–æ** –≤ –Ω–∞—à–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏

–≠—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—à–∏–±–æ–∫ –æ–¥–∏–Ω–∞–∫–æ–≤—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏. –†–∞–∑–ª–∏—á–∞–µ—Ç—Å—è –ª–∏—à—å —É—Ä–æ–≤–µ–Ω—å, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º—ã –≤—ã—á–∏—Å–ª—è–µ–º —ç—Ç–∏ –æ—à–∏–±–∫–∏: –º—ã
–º–æ–∂–µ–º –≤—ã—á–∏—Å–ª—è—Ç—å –∏—Ö –ª–∏–±–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ _—Å–ª–æ–≤–∞_, –ª–∏–±–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ _—Å–∏–º–≤–æ–ª–∞_.

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –º–µ—Ç—Ä–∏–∫–∏ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–π –ø—Ä–∏–º–µ—Ä. –ù–∏–∂–µ –º—ã –≤–∏–¥–∏–º _–∏—Å—Ç–∏–Ω—É_ –∏–ª–∏ _—ç—Ç–∞–ª–æ–Ω–Ω—É—é_ (_reference_) —Ç–µ–∫—Å—Ç–æ–≤—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```python
reference = "the cat sat on the mat"
```

–ò –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø—ã—Ç–∞–µ–º—Å—è –æ—Ü–µ–Ω–∏—Ç—å:

```python
prediction = "the cat sit on the"
```

–í–∏–¥–Ω–æ, —á—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–æ–≤–æ–ª—å–Ω–æ –±–ª–∏–∑–∫–æ, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–ª–æ–≤–∞ –Ω–µ —Å–æ–≤—Å–µ–º –≤–µ—Ä–Ω—ã. –û—Ü–µ–Ω–∏–º —ç—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å —ç—Ç–∞–ª–æ–Ω–æ–º –¥–ª—è —Ç—Ä–µ—Ö
–Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ —Ü–∏—Ñ—Ä—ã –º—ã –ø–æ–ª—É—á–∏–º –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö.

## –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ –≤ —Å–ª–æ–≤–∞—Ö (Word Error Rate)
–ú–µ—Ç—Ä–∏–∫–∞ *word error rate (WER)* —è–≤–ª—è–µ—Ç—Å—è "—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π" –º–µ—Ç—Ä–∏–∫–æ–π –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏. –û–Ω–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞–º–µ–Ω—ã, –≤—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–∞–ª–µ–Ω–∏—è
–Ω–∞ *—É—Ä–æ–≤–Ω–µ —Å–ª–æ–≤–∞*. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ—à–∏–±–∫–∏ –∞–Ω–Ω–æ—Ç–∏—Ä—É—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞. –í–æ–∑—å–º–µ–º –Ω–∞—à –ø—Ä–∏–º–µ—Ä:

| –≠—Ç–∞–ª–æ–Ω:     | the | cat | sat     | on  | the | mat |
|-------------|-----|-----|---------|-----|-----|-----|
| –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: | the | cat | **sit** | on  | the |     |  |
| –ú–µ—Ç–∫–∞:      | ‚úÖ   | ‚úÖ   | S       | ‚úÖ   | ‚úÖ   | D   |

–ó–¥–µ—Å—å:
* 1 –∑–∞–º–µ–Ω–∞ (S) ("sit" –≤–º–µ—Å—Ç–æ "sat")
* 0 –≤—Å—Ç–∞–≤–æ–∫
* 1 —É–¥–∞–ª–µ–Ω–∏–µ (D) ("mat" –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)

–≠—Ç–æ –¥–∞–µ—Ç 2 –æ—à–∏–±–∫–∏ –≤ —Å—É–º–º–µ. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ—à–∏–±–æ–∫, —Ä–∞–∑–¥–µ–ª–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –Ω–∞ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ —ç—Ç–∞–ª–æ–Ω–Ω–æ–π
–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (N), –∫–æ—Ç–æ—Ä–æ–µ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ —Ä–∞–≤–Ω–æ 6:

$$
\begin{aligned}
WER &= \frac{S + I + D}{N} \\
&= \frac{1 + 0 + 1}{6} \\
&= 0.333
\end{aligned}
$$

–û—Ç–ª–∏—á–Ω–æ! –ò—Ç–∞–∫, WER —Ä–∞–≤–µ–Ω 0,333, –∏–ª–∏ 33,3%. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤ —Å–ª–æ–≤–µ "sit" –æ—à–∏–±–æ—á–Ω—ã–º —è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª,
–Ω–æ –≤—Å–µ —Å–ª–æ–≤–æ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ. –≠—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –æ—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω–æ–π –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å—é WER: –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ —Å–∏–ª—å–Ω–æ —à—Ç—Ä–∞—Ñ—É—é—Ç—Å—è,
–∫–∞–∫–∏–º–∏ –±—ã –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–Ω–∏ –Ω–∏ –±—ã–ª–∏.

WER –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–∞–∫: —á–µ–º –º–µ–Ω—å—à–µ WER, —Ç–µ–º –º–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –≤ –ø—Ä–æ–≥–Ω–æ–∑–µ, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ WER
–±—ã–ª –±—ã —Ä–∞–≤–µ–Ω –Ω—É–ª—é (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫).

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å WER —Å –ø–æ–º–æ—â—å—é ü§ó Evaluate. –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏ WER –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –¥–≤–∞ –ø–∞–∫–µ—Ç–∞: ü§ó Evaluate
–¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ API –∏ JIWER –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—è–∂–µ–ª–æ–π —Ä–∞–±–æ—Ç—ã –ø–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—é:
```
pip install --upgrade evaluate jiwer
```

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ—Ç—Ä–∏–∫—É WER –∏ –≤—ã—á–∏—Å–ª–∏—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:

```python
from evaluate import load

wer_metric = load("wer")

wer = wer_metric.compute(references=[reference], predictions=[prediction])

print(wer)
```
**Print Output:**
```
0.3333333333333333
```

0,33, –∏–ª–∏ 33,3%, –∫–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å! –¢–µ–ø–µ—Ä—å –º—ã –∑–Ω–∞–µ–º, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Ä–∞—Å—á–µ—Ç WER.

–ê —Ç–µ–ø–µ—Ä—å –∫–æ–µ-—á—Ç–æ, —á—Ç–æ —Å–±–∏–≤–∞–µ—Ç —Å —Ç–æ–ª–∫—É... –ö–∞–∫ –í—ã –¥—É–º–∞–µ—Ç–µ, –∫–∞–∫–æ–≤–∞ –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ WER? –í—ã –æ–∂–∏–¥–∞–µ—Ç–µ, —á—Ç–æ –æ–Ω –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω 1 –∏–ª–∏
100%, –≤–µ—Ä–Ω–æ? –¢–∞–∫ –∫–∞–∫ WER - —ç—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—à–∏–±–æ–∫ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–ª–æ–≤ (N), —Ç–æ –≤–µ—Ä—Ö–Ω–µ–≥–æ –ø—Ä–µ–¥–µ–ª–∞ –¥–ª—è WER –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
–í–æ–∑—å–º–µ–º –ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –º—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∏ 10 —Å–ª–æ–≤, –∞ —É —Ü–µ–ª–µ–≤–æ–π —Ñ—Ä–∞–∑—ã —Ç–æ–ª—å–∫–æ 2 —Å–ª–æ–≤–∞. –ï—Å–ª–∏ –±—ã –≤—Å–µ –Ω–∞—à–∏ –ø—Ä–æ–≥–Ω–æ–∑—ã –æ–∫–∞–∑–∞–ª–∏—Å—å –Ω–µ–≤–µ—Ä–Ω—ã–º–∏
(10 –æ—à–∏–±–æ–∫), —Ç–æ WER –±—ã–ª –±—ã —Ä–∞–≤–µ–Ω 10 / 2 = 5, –∏–ª–∏ 500%! –û–± —ç—Ç–æ–º —Å–ª–µ–¥—É–µ—Ç –ø–æ–º–Ω–∏—Ç—å, –µ—Å–ª–∏ –≤—ã –æ–±—É—á–∞–µ—Ç–µ ASR-—Å–∏—Å—Ç–µ–º—É –∏ –≤–∏–¥–∏—Ç–µ, —á—Ç–æ WER
–ø—Ä–µ–≤—ã—à–∞–µ—Ç 100%. –•–æ—Ç—è –µ—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ —ç—Ç–æ, —Ç–æ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫... üòÖ

## –¢–æ—á–Ω–æ—Å—Ç—å —Å–ª–æ–≤ (Word Accuracy)

–ú—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å WER, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –º–µ—Ç—Ä–∏–∫—É, –≤ –∫–æ—Ç–æ—Ä–æ–π *–±–æ–ª—å—à–µ - –ª—É—á—à–µ*. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∏–∑–º–µ—Ä—è—Ç—å —á–∞—Å—Ç–æ—Ç—É –æ—à–∏–±–æ–∫ –≤ —Å–ª–æ–≤–∞—Ö,
–º—ã –º–æ–∂–µ–º –∏–∑–º–µ—Ä–∏—Ç—å *—Ç–æ—á–Ω–æ—Å—Ç—å —Å–ª–æ–≤ (WAcc)* –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã:

$$
\begin{equation}
WAcc = 1 - WER \nonumber
\end{equation}
$$

WAcc —Ç–∞–∫–∂–µ –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–ª–æ–≤, –ø—Ä–æ—Å—Ç–æ WER –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω (—Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω) –∫–∞–∫ –º–µ—Ç—Ä–∏–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –º–µ—Ç—Ä–∏–∫–∞ –æ—à–∏–±–∫–∏. WAcc –æ—á–µ–Ω—å —Ä–µ–¥–∫–æ
–≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ —Ä–µ—á–µ–≤–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ - –º—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –æ—à–∏–±–æ–∫ –≤ —Å–ª–æ–≤–∞—Ö, –∏ –ø–æ—ç—Ç–æ–º—É –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏
–æ—à–∏–±–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ –∞—Å—Å–æ—Ü–∏–∏—Ä—É—é—Ç—Å—è —Å —ç—Ç–∏–º–∏ –æ—à–∏–±–∫–∞–º–∏.

## –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ –≤ —Å–∏–º–≤–æ–ª–∞—Ö (Character Error Rate)

–ö–∞–∂–µ—Ç—Å—è –Ω–µ–º–Ω–æ–≥–æ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–º, —á—Ç–æ –º—ã –ø–æ–º–µ—Ç–∏–ª–∏ –≤—Å–µ —Å–ª–æ–≤–æ "sit" –æ—à–∏–±–æ—á–Ω—ã–º, –∫–æ–≥–¥–∞ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –±—É–∫–≤–∞.
–≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –º—ã –æ—Ü–µ–Ω–∏–≤–∞–ª–∏ –Ω–∞—à—É —Å–∏—Å—Ç–µ–º—É –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–ª–æ–≤, —Ç–µ–º —Å–∞–º—ã–º –∞–Ω–Ω–æ—Ç–∏—Ä—É—è –æ—à–∏–±–∫–∏ –ø–æ—Å–ª–æ–≤–Ω–æ (word-by-word). –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å *—á–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫
–≤ —Å–∏–º–≤–æ–ª–∞—Ö (CER)* –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º—ã –Ω–∞ *—Å–∏–º–≤–æ–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ*. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã —Ä–∞–∑–±–∏–≤–∞–µ–º —Å–ª–æ–≤–∞ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –∏ –∞–Ω–Ω–æ—Ç–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É
—Å–∏–º–≤–æ–ª—É:

| –≠—Ç–∞–ª–æ–Ω:     | t   | h   | e   |     | c   | a   | t   |     | s   | a     | t   |     | o   | n   |     | t   | h   | e   |     | m   | a   | t   |
|-------------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: | t   | h   | e   |     | c   | a   | t   |     | s   | **i** | t   |     | o   | n   |     | t   | h   | e   |     |     |     |     |
| –ú–µ—Ç–∫–∞:      | ‚úÖ   | ‚úÖ   | ‚úÖ   |     | ‚úÖ   | ‚úÖ   | ‚úÖ   |     | ‚úÖ   | S     | ‚úÖ   |     | ‚úÖ   | ‚úÖ   |     | ‚úÖ   | ‚úÖ   | ‚úÖ   |     | D   | D   | D   |

–¢–µ–ø–µ—Ä—å –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –≤ —Å–ª–æ–≤–µ "sit" –±—É–∫–≤—ã "s" –∏ "t" –æ—Ç–º–µ—á–µ–Ω—ã –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ. –ò —Ç–æ–ª—å–∫–æ "i" –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –æ—à–∏–±–∫–∞ –∑–∞–º–µ–Ω—ã —Å–∏–º–≤–æ–ª–∞ (S). –¢–∞–∫–∏–º
–æ–±—Ä–∞–∑–æ–º, –º—ã –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–∞–µ–º –Ω–∞—à—É —Å–∏—Å—Ç–µ–º—É –∑–∞ —á–∞—Å—Ç–∏—á–Ω–æ –≤–µ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ ü§ù.

–í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –∏–º–µ–µ–º 1 –∑–∞–º–µ–Ω—É —Å–∏–º–≤–æ–ª–æ–≤, 0 –≤—Å—Ç–∞–≤–æ–∫ –∏ 3 —É–¥–∞–ª–µ–Ω–∏—è. –í—Å–µ–≥–æ —É –Ω–∞—Å 14 —Å–∏–º–≤–æ–ª–æ–≤. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞—à CER –∏–º–µ–µ—Ç –≤–∏–¥:

$$
\begin{aligned}
CER &= \frac{S + I + D}{N} \\
&= \frac{1 + 0 + 3}{14} \\
&= 0.286
\end{aligned}
$$

–û—Ç–ª–∏—á–Ω–æ! –ú—ã –ø–æ–ª—É—á–∏–ª–∏ CER, —Ä–∞–≤–Ω—ã–π 0,286, –∏–ª–∏ 28,6%. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ –º–µ–Ω—å—à–µ, —á–µ–º WER - –º—ã –≥–æ—Ä–∞–∑–¥–æ –º–µ–Ω—å—à–µ –Ω–∞–∫–∞–∑—ã–≤–∞–ª–∏
–∑–∞ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É.

## –ö–∞–∫—É—é –º–µ—Ç—Ä–∏–∫—É —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

–í —Ü–µ–ª–æ–º –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–µ—á–µ–≤—ã—Ö —Å–∏—Å—Ç–µ–º WER –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ —á–∞—â–µ, —á–µ–º CER. –≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ WER —Ç—Ä–µ–±—É–µ—Ç –æ—Ç —Å–∏—Å—Ç–µ–º –±–æ–ª–µ–µ
–≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤. –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ —Å–ª–æ–≤–æ "sit" –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –°–∏—Å—Ç–µ–º–∞, –ø–æ–Ω–∏–º–∞—é—â–∞—è —Å–≤—è–∑—å
–º–µ–∂–¥—É –≥–ª–∞–≥–æ–ª–æ–º –∏ –≤—Ä–µ–º–µ–Ω–µ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º —É–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç—Å—è —Å–ª–æ–≤–æ, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ –±—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≥–ª–∞–≥–æ–ª–∞ "sat". –ú—ã —Ö–æ—Ç–∏–º –ø–æ–æ—â—Ä—è—Ç—å —Ç–∞–∫–æ–π
—É—Ä–æ–≤–µ–Ω—å –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –Ω–∞—à–∏—Ö —Ä–µ—á–µ–≤—ã—Ö —Å–∏—Å—Ç–µ–º. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Ö–æ—Ç—è WER –º–µ–Ω–µ–µ —â–∞–¥—è—â–∏–º, —á–µ–º CER, –æ–Ω —Ç–∞–∫–∂–µ –±–æ–ª–µ–µ –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–µ–Ω
–¥–ª—è —Ç–µ—Ö –≤–∏–¥–æ–≤ —Ä–∞–∑–±–æ—Ä—á–∏–≤—ã—Ö —Å–∏—Å—Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Ö–æ—Ç–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å. –ü–æ—ç—Ç–æ–º—É –º—ã –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º WER –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º —ç—Ç–æ –¥–µ–ª–∞—Ç—å!
–û–¥–Ω–∞–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WER –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —è–∑—ã–∫–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ –º–∞–Ω–¥–∞—Ä–∏–Ω—Å–∫–∏–π (—Å–µ–≤–µ—Ä–Ω–æ–∫–∏—Ç–∞–π—Å–∫–∏–π
—è–∑—ã–∫) –∏ —è–ø–æ–Ω—Å–∫–∏–π, –ø–æ–Ω—è—Ç–∏–µ "—Å–ª–æ–≤–∞" –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∏ –ø–æ—ç—Ç–æ–º—É WER –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞. –ó–¥–µ—Å—å –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é CER.

–í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ WER –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ. –ü—Ä–∏ –æ—Ü–µ–Ω–∫–µ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º—ã –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ü–µ–ª—ã–π
—Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç—ã—Å—è—á –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π. –ü—Ä–∏ –æ—Ü–µ–Ω–∫–µ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º –º—ã —Å—É–º–º–∏—Ä—É–µ–º S, I, D –∏ N –ø–æ –≤—Å–µ–º
–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º, –∞ –∑–∞—Ç–µ–º –≤—ã—á–∏—Å–ª—è–µ–º WER –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ñ–æ—Ä–º—É–ª–æ–π, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–π –≤—ã—à–µ. –≠—Ç–æ –¥–∞–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –æ—Ü–µ–Ω–∫—É WER –¥–ª—è –¥–∞–Ω–Ω—ã—Ö,
–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Ä–∞–Ω–µ–µ.

## –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

–ï—Å–ª–∏ –º—ã –æ–±—É—á–∏–º –º–æ–¥–µ–ª—å ASR –Ω–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø—É–Ω–∫—Ç—É–∞—Ü–∏–µ–π –∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ–º –±—É–∫–≤, –æ–Ω–∞ –Ω–∞—É—á–∏—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é –≤ —Å–≤–æ–∏—Ö —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è—Ö.
–≠—Ç–æ –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–≥–¥–∞ –Ω–∞–º –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞–Ω–∏–µ
—Å–æ–≤–µ—â–∞–Ω–∏–π –∏–ª–∏ –¥–∏–∫—Ç–æ–≤–∫–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –±—É–¥—É—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω—ã —Å —É—á–µ—Ç–æ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏, —Å—Ç–∏–ª—è,
–Ω–∞–∑—ã–≤–∞–µ–º–æ–≥–æ *–æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º*.

–û–¥–Ω–∞–∫–æ —É –Ω–∞—Å —Ç–∞–∫–∂–µ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å *–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å* –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–µ–ª–∞–µ—Ç –∑–∞–¥–∞—á—É
—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –ø—Ä–æ—â–µ: –º–æ–¥–µ–ª–∏ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å —Å–∏–º–≤–æ–ª—ã –≤–µ—Ä—Ö–Ω–µ–≥–æ –∏ –Ω–∏–∂–Ω–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏–ª–∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é —Ç–æ–ª—å–∫–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ
–∞—É–¥–∏–æ–¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∫–æ–π –∑–≤—É–∫ –∏–∑–¥–∞–µ—Ç —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π?). –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –æ—à–∏–±–∫–∏ —Å–ª–æ–≤ —Å–Ω–∏–∂–∞—é—Ç—Å—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º (—á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç,
—á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ª—É—á—à–µ). –í —Å—Ç–∞—Ç—å–µ –æ –º–æ–¥–µ–ª–∏ Whisper –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã WER
(—Å–º. —Ä–∞–∑–¥–µ–ª 4.4 –≤ [—Å—Ç–∞—Ç—å–µ Whisper](https://cdn.openai.com/papers/whisper.pdf)). –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ WER, –º–æ–¥–µ–ª—å –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª—É—á—à–µ –¥–ª—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏ –¥–µ–ª–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—Ç –º–æ–¥–µ–ª–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä—É–¥–Ω–µ–µ
–¥–ª—è —á—Ç–µ–Ω–∏—è. –í–æ–∑—å–º–µ–º –ø—Ä–∏–º–µ—Ä –∏–∑ [–ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞](asr_models), –≥–¥–µ –º—ã –ø—Ä–∏–º–µ–Ω–∏–ª–∏ –º–æ–¥–µ–ª–∏ Wav2Vec2 –∏ Whisper –∫ –æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ –∞—É–¥–∏–æ—Ñ—Ä–∞–≥–º–µ–Ω—Ç—É
–∏–∑ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö LibriSpeech. –ú–æ–¥–µ–ª—å Wav2Vec2 –Ω–µ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—é, –Ω–∏ —Ä–µ–≥–∏—Å—Ç—Ä, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ Whisper –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±–∞ —ç—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–∞.
–°—Ä–∞–≤–Ω–∏–≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Ä—è–¥–æ–º, –º—ã –≤–∏–¥–∏–º, —á—Ç–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è Whisper –≥–æ—Ä–∞–∑–¥–æ –ø—Ä–æ—â–µ –¥–ª—è —á—Ç–µ–Ω–∏—è:

```
Wav2Vec2:  HE TELLS US THAT AT THIS FESTIVE SEASON OF THE YEAR WITH CHRISTMAUS AND ROSE BEEF LOOMING BEFORE US SIMALYIS DRAWN FROM EATING AND ITS RESULTS OCCUR MOST READILY TO THE MIND
Whisper:   He tells us that at this festive season of the year, with Christmas and roast beef looming before us, similarly is drawn from eating and its results occur most readily to the mind.
```

–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è Whisper —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏–∏ –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é - –æ–Ω–∞ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ç–∞–∫, –∫–∞–∫ –º—ã –æ–∂–∏–¥–∞–µ–º –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Å–æ–≤–µ—â–∞–Ω–∏—è
–∏–ª–∏ –¥–∏–∫—Ç–æ–≤–∫–∏, —Å –ø—É–Ω–∫—Ç—É–∞—Ü–∏–µ–π –∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ–º –±—É–∫–≤. –ù–∞–ø—Ä–æ—Ç–∏–≤, –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞ –≤ –Ω–∞—à–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö Wav2Vec2 –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è
–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –∑–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞ –º–µ–∂–¥—É –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏: –º—ã –º–æ–∂–µ–º –æ–±—É—á–∞—Ç—å –Ω–∞—à–∏ —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è—Ö,
–∞ –∑–∞—Ç–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ —Ü–µ–ª–µ–≤—ã–µ –º–µ—Ç–∫–∏ –ø–µ—Ä–µ–¥ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º WER. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –æ–±—É—á–∞–µ–º –Ω–∞—à–∏ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
–æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç, –Ω–æ —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∞–µ–º –≤—ã–≥–æ–¥—É –æ—Ç —É–ª—É—á—à–µ–Ω–∏–π WER, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø–æ–ª—É—á–∞–µ–º, –Ω–æ—Ä–º–∞–ª–∏–∑—É—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏.

–ú–æ–¥–µ–ª—å Whisper –±—ã–ª–∞ –≤—ã–ø—É—â–µ–Ω–∞ —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é —Ä–µ–≥–∏—Å—Ç—Ä–∞, –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–∏—Å–µ–ª, —Å—Ä–µ–¥–∏
–ø—Ä–æ—á–µ–≥–æ. –î–∞–≤–∞–π—Ç–µ –ø—Ä–∏–º–µ–Ω–∏–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä –∫ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è–º Whisper, —á—Ç–æ–±—ã –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫ –º—ã –º–æ–∂–µ–º –∏—Ö –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å:

```python
from transformers.models.whisper.english_normalizer import BasicTextNormalizer

normalizer = BasicTextNormalizer()

prediction = " He tells us that at this festive season of the year, with Christmas and roast beef looming before us, similarly is drawn from eating and its results occur most readily to the mind."
normalized_prediction = normalizer(prediction)

normalized_prediction
```
**Output:**
```
' he tells us that at this festive season of the year with christmas and roast beef looming before us similarly is drawn from eating and its results occur most readily to the mind '
```

–û—Ç–ª–∏—á–Ω–æ! –ú—ã –≤–∏–¥–∏–º, —á—Ç–æ —Ç–µ–∫—Å—Ç –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–∏–≤–µ–¥–µ–Ω –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –∏ —É–¥–∞–ª–µ–Ω–∞ –≤—Å—è –ø—É–Ω–∫—Ç—É–∞—Ü–∏—è. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏–º —ç—Ç–∞–ª–æ–Ω–Ω—É—é —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é
–∏ –∑–∞—Ç–µ–º –≤—ã—á–∏—Å–ª–∏–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π WER –º–µ–∂–¥—É —ç—Ç–∞–ª–æ–Ω–æ–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º:

```python
reference = "HE TELLS US THAT AT THIS FESTIVE SEASON OF THE YEAR WITH CHRISTMAS AND ROAST BEEF LOOMING BEFORE US SIMILES DRAWN FROM EATING AND ITS RESULTS OCCUR MOST READILY TO THE MIND"
normalized_referece = normalizer(reference)

wer = wer_metric.compute(
    references=[normalized_referece], predictions=[normalized_prediction]
)
wer
```
**Output:**
```
0.0625
```

6,25% - —ç—Ç–æ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–æ, —á—Ç–æ –º—ã –æ–∂–∏–¥–∞–µ–º –¥–ª—è –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ Whisper –Ω–∞ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö LibriSpeech –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏. –ö–∞–∫ –º—ã –≤–∏–¥–∏–º –∑–¥–µ—Å—å, –º—ã
–ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é, –Ω–æ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è –ø–æ–ª—É—á–∏–ª–∏ —É–ª—É—á—à–µ–Ω–∏–µ WER, –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–∞–ª–æ–Ω–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
–ø–µ—Ä–µ–¥ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º WER.

–í—ã–±–æ—Ä —Å–ø–æ—Å–æ–±–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–∏—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π. –ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º —Ç–µ–∫—Å—Ç–µ
–∏ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º —Ç–µ–∫—Å—Ç–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ª—É—á—à–µ–µ –∏–∑ –æ–±–æ–∏—Ö –ø—Ä–∏–µ–º–æ–≤.

### –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –≤–æ–µ–¥–∏–Ω–æ

–•–æ—Ä–æ—à–æ! –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ —Ç—Ä–∏ —Ç–µ–º—ã –≤ —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ: –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏, –≤—ã–±–æ—Ä –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ü–µ–Ω–∫—É. –î–∞–≤–∞–π—Ç–µ –≤–µ—Å–µ–ª–æ –ø—Ä–æ–≤–µ–¥–µ–º –≤—Ä–µ–º—è –∏
–æ–±—ä–µ–¥–∏–Ω–∏–º –∏—Ö –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ end-to-end üöÄ –ú—ã –±—É–¥–µ–º –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞–∑–¥–µ–ª—É –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –º–æ–¥–µ–ª–∏ –ø—É—Ç–µ–º –æ—Ü–µ–Ω–∫–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–æ–π
–º–æ–¥–µ–ª–∏ Whisper –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö Common Voice 13 –Ω–∞ –î–∏–≤–µ—Ö–∏. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ WER –∫–∞–∫ _baseline_ –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–æ–æ–±—É—á–µ–Ω–∏—è
–∏–ª–∏ –∫–∞–∫ —Ü–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –ø—Ä–µ–≤–∑–æ–π—Ç–∏ ü•ä.

–°–Ω–∞—á–∞–ª–∞ –º—ã –∑–∞–≥—Ä—É–∑–∏–º –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å Whisper —Å –ø–æ–º–æ—â—å—é `pipeline()`. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤–∞–º —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—Ä–∞–π–Ω–µ –∑–Ω–∞–∫–æ–º!
–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –Ω–æ–≤–æ–µ, —á—Ç–æ –º—ã —Å–¥–µ–ª–∞–µ–º - —ç—Ç–æ –∑–∞–≥—Ä—É–∑–∏–º –º–æ–¥–µ–ª—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–æ–ª–æ–≤–∏–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ (float16), –µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–∞ GPU.
–≠—Ç–æ —É—Å–∫–æ—Ä–∏—Ç –≤—ã–≤–æ–¥, –ø–æ—á—Ç–∏ –Ω–µ –≤–ª–∏—è—è –Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç—å WER.

```python
from transformers import pipeline
import torch

if torch.cuda.is_available():
    device = "cuda:0"
    torch_dtype = torch.float16
else:
    device = "cpu"
    torch_dtype = torch.float32

pipe = pipeline(
    "automatic-speech-recognition",
    model="openai/whisper-small",
    torch_dtype=torch_dtype,
    device=device,
)
```

–ó–∞—Ç–µ–º –º—ã –∑–∞–≥—Ä—É–∑–∏–º —Ç–µ—Å—Ç–æ–≤—É—é —á–∞—Å—Ç—å –î–∏–≤–µ—Ö–∏ –∏–∑ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Common Voice 13. –í—ã –ø–æ–º–Ω–∏—Ç–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞, —á—Ç–æ Common Voice 13 —è–≤–ª—è–µ—Ç—Å—è
–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –¥–æ–ª–∂–Ω—ã —Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è —Å —É—Å–ª–æ–≤–∏—è–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–º—É. –¢–µ–ø–µ—Ä—å
–º—ã –º–æ–∂–µ–º —Å–≤—è–∑–∞—Ç—å –Ω–∞—à—É —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å Hugging Face —Å –Ω–∞—à–∏–º –±–ª–æ–∫–Ω–æ—Ç–æ–º, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö —Å –º–∞—à–∏–Ω—ã, –∫–æ—Ç–æ—Ä—É—é –º—ã —Å–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ–º.

–°–≤—è–∑–∞—Ç—å –±–ª–æ–∫–Ω–æ—Ç —Å Hugging Face Hub –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ - —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–≤–æ–¥–∞ –≤–∞—à–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –≤–∞—Å –ø–æ–ø—Ä–æ—Å—è—Ç. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
Hugging Face Hub [–∑–¥–µ—Å—å](https://huggingface.co/settings/tokens) –∏ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ, –∫–æ–≥–¥–∞ –≤–∞—Å –ø–æ–ø—Ä–æ—Å—è—Ç:

```python
from huggingface_hub import notebook_login

notebook_login()
```

–û—Ç–ª–∏—á–Ω–æ! –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã —Å–≤—è–∂–µ–º –±–ª–æ–∫–Ω–æ—Ç —Å –Ω–∞—à–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é Hugging Face, –º—ã –º–æ–∂–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Common Voice.
–≠—Ç–æ –∑–∞–π–º–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É, –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ–ª—É—á–µ–Ω—ã —Å Hub Hugging Face –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
–≤ –≤–∞—à–µ–º –±–ª–æ–∫–Ω–æ—Ç–µ:

```python
from datasets import load_dataset

common_voice_test = load_dataset(
    "mozilla-foundation/common_voice_13_0", "dv", split="test"
)
```

<Tip>
    –ï—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω–µ—Ç–µ—Å—å —Å –ø—Ä–æ–±–ª–µ–º–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø—Ä–∏–Ω—è–ª–∏ —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞
    Hub Hugging Face –ø–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Å—ã–ª–∫–µ: https://huggingface.co/datasets/mozilla-foundation/common_voice_13_0
</Tip>

–û—Ü–µ–Ω–∫–∞ –ø–æ –≤—Å–µ–º—É –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ - –≤—Å–µ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ **—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏** –ø—Ä–æ–π—Ç–∏ –ø–æ
–≤—Ö–æ–¥–Ω—ã–º –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞–º, –≤–º–µ—Å—Ç–æ –≤—ã–≤–æ–¥–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞. –î–ª—è —ç—Ç–æ–≥–æ –º—ã —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–∞—à –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ `KeyDataset`. –ü—Ä–∏ —ç—Ç–æ–º –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è
–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Ö–æ—Ç–∏–º –ø–µ—Ä–µ–¥–∞—Ç—å –º–æ–¥–µ–ª–∏ (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ —Å—Ç–æ–ª–±–µ—Ü `"audio"`), –∏–≥–Ω–æ—Ä–∏—Ä—É—è –æ—Å—Ç–∞–ª—å–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä,
—Ü–µ–ª–µ–≤—ã–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –Ω–µ —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã–≤–æ–¥–∞). –ó–∞—Ç–µ–º –º—ã –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º —ç—Ç–æ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –¥–æ–±–∞–≤–ª—è—è –≤—ã—Ö–æ–¥—ã
–º–æ–¥–µ–ª–∏ –≤ —Å–ø–∏—Å–æ–∫ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π. –≠—Ç–æ—Ç –±–ª–æ–∫ –∫–æ–¥–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –æ–∫–æ–ª–æ –ø—è—Ç–∏ –º–∏–Ω—É—Ç –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ GPU —Å –ø–æ–ª–æ–≤–∏–Ω–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é
–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç—å—é 12 –ì–ë:

```python
from tqdm import tqdm
from transformers.pipelines.pt_utils import KeyDataset

all_predictions = []

# run streamed inference
for prediction in tqdm(
    pipe(
        KeyDataset(common_voice_test, "audio"),
        max_new_tokens=128,
        generate_kwargs={"task": "transcribe"},
        batch_size=32,
    ),
    total=len(common_voice_test),
):
    all_predictions.append(prediction["text"])
```

<Tip>
    –ï—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω–µ—Ç–µ—Å—å —Å –æ—à–∏–±–∫–æ–π "Out-of-Memory" (OOM) CUDA –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω–æ–π —è—á–µ–π–∫–∏, —É–º–µ–Ω—å—à–∞–π—Ç–µ —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ (`batch_size`)
    –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–¥–≤–æ–µ, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ—Ç–µ —Ç–∞–∫–æ–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤–∞—à–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
</Tip>

–ò, –Ω–∞–∫–æ–Ω–µ—Ü, –º—ã –º–æ–∂–µ–º –≤—ã—á–∏—Å–ª–∏—Ç—å WER. –î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –≤—ã—á–∏—Å–ª–∏–º –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π WER, —Ç–æ –µ—Å—Ç—å WER –±–µ–∑ –∫–∞–∫–æ–π-–ª–∏–±–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```python
from evaluate import load

wer_metric = load("wer")

wer_ortho = 100 * wer_metric.compute(
    references=common_voice_test["sentence"], predictions=all_predictions
)
wer_ortho
```
**Output:**
```
167.29577268612022
```

–õ–∞–¥–Ω–æ... 167% –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –≤—ã–¥–∞–µ—Ç –º—É—Å–æ—Ä üòú –ù–µ –±–µ—Å–ø–æ–∫–æ–π—Ç–µ—Å—å, –Ω–∞—à–µ–π —Ü–µ–ª—å—é –±—É–¥–µ—Ç —É–ª—É—á—à–∏—Ç—å —ç—Ç–æ –ø—É—Ç–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
–º–æ–¥–µ–ª–∏ –Ω–∞ –æ–±—É—á–∞—é—â–µ–º –≤—ã–±–æ—Ä–∫–µ –î–∏–≤–µ—Ö–∏!

–ó–∞—Ç–µ–º –º—ã –æ—Ü–µ–Ω–∏–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π WER, —Ç–æ –µ—Å—Ç—å WER —Å –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤ —á–∞—Å—Ç–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏. –ù–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç—å –≤—ã–±–æ—Ä–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –±—ã –ø—É—Å—Ç—ã–º–∏
–ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤ –≤ –Ω–∞—à–µ–º —ç—Ç–∞–ª–æ–Ω–µ (N) –±—É–¥–µ—Ç —Ä–∞–≤–Ω–æ –Ω—É–ª—é, —á—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å –≤
–Ω–∞—à–µ–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏:

```python
from transformers.models.whisper.english_normalizer import BasicTextNormalizer

normalizer = BasicTextNormalizer()

# compute normalised WER
all_predictions_norm = [normalizer(pred) for pred in all_predictions]
all_references_norm = [normalizer(label) for label in common_voice_test["sentence"]]

# filtering step to only evaluate the samples that correspond to non-zero references
all_predictions_norm = [
    all_predictions_norm[i]
    for i in range(len(all_predictions_norm))
    if len(all_references_norm[i]) > 0
]
all_references_norm = [
    all_references_norm[i]
    for i in range(len(all_references_norm))
    if len(all_references_norm[i]) > 0
]

wer = 100 * wer_metric.compute(
    references=all_references_norm, predictions=all_predictions_norm
)

wer
```
**Output:**
```
125.69809089960707
```

–°–Ω–æ–≤–∞ –º—ã –≤–∏–¥–∏–º —Ä–µ–∑–∫–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ WER –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—à–∏—Ö —ç—Ç–∞–ª–æ–Ω–æ–≤ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π: –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ
—Ç–µ—Å—Ç–æ–≤–æ–≥–æ WER 168%, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π WER —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 126%.

–ò—Ç–∞–∫, –∏–º–µ–Ω–Ω–æ —ç—Ç–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –º—ã —Ö–æ—Ç–∏–º –ø—Ä–µ–≤–∑–æ–π—Ç–∏, –∫–æ–≥–¥–∞ –±—É–¥–µ–º –¥–æ–æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª—å, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å –º–æ–¥–µ–ª—å Whisper –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –¥–ª—è –î–∏–≤–µ—Ö–∏.
–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —á—Ç–µ–Ω–∏–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ–ø—ã—Ç —Å –ø—Ä–∏–º–µ—Ä–æ–º –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ üöÄ.